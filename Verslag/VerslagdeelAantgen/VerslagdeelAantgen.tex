
\section{Average number of generations until equilibrium}\label{sec:aantgen}
There are numerous parameters that may affect the average number of generations until  equilibrium is reached. 
We chose to focus on the effect of the Happiness Rule (HR) on the average number of generations. 
For each HR ranging from 0 to 1 with increment 0.01, we ran 500 simulations and calculated the average, maximal and minimal generations it took to reach equilibrium. 
The results are shown in figure \ref{fig:avegen}.\\

From Figure \ref{fig:avegen}, we conclude that the average number of generations (blue graph) is increasing with the Happiness Rule, which is to be expected since a higher HR implies a higher need for neighbours of the same type, and thus a lower probability that a selected individual is happy, making it more likely that he/she will move. 
We also note that starting at a HR of aproximately 0.7, the average number of generations appears to be nearly constant. 
This can be explained noting that the required number of neighbours will practically be the same. 
For example, if the HR were 0.8, a person with 3, 5 or 8 neighbours would require respectively 3, 5 or at least 7 of the same type. 
This requirement hardly changes if a HR of 0.9 is applied. 
The same argument explains why the average number of generations is constant at very low HR or if we raise the HR with a sufficiently small amount like $0.01$.

\begin{figure}[h!]
    \centering
    \includegraphics[width=0.9\textwidth]{happinessregel_aantgen_2.pdf}
    \caption{Effect of the happiness rule on the number of generations until reaching equilibrium. 
    The green graph represents the maximal number of generations, the blue graph the average number of generations and the red graph displays the minimal number of generations}
    \label{fig:avegen}
\end{figure}

It is also interesting to investigate how the random variables $Y_j$, which we denote as the number of generations it takes to reach the equilibrium under HR $j$, is distributed, and how their distributions are effected by the HR. 
For this purpose, we ran 10000 simulations for with Happiness Rules of \(\frac{1}{4},\frac{1}{3},\frac{1}{2}\) and 1 and plotted several histograms (Figure \ref{fig:histogram}). 
We chose bin size 1 for each histogram given that $Y_j$ is a random variable that only takes integer values. 
Therefore, a histogram with a bin of $0.5$ will not give any additional information, but there would be a severe loss of information if bin size $2$ is chosen. 

\begin{figure}[H]
    \centering
    \begin{subfigure}{0.45\textwidth}
        \includegraphics[width=\textwidth]{GenormHistogramAantalgen4.pdf}
        \caption{10000 simulations of number of generations until equilibrium with HR 1/4}
        \label{hist hap 1/4}
    \end{subfigure}
	~
    \begin{subfigure}{0.45\textwidth}
        \includegraphics[width=\textwidth]{GenormHistogramAantalgen.pdf}
        \caption{10000 simulations of number of generations until equilibrium with HR 1/3}
        \label{hist hap 1/3}
    \end{subfigure}
	~
    \begin{subfigure}{0.45\textwidth}
        \includegraphics[width=\textwidth]{GenormHistogramAantalgen2.pdf}
        \caption{10000 simulations of number of generations until equilibrium with HR 1/2}
        \label{hist hap 1/2}
    \end{subfigure}
    ~
    \begin{subfigure}{0.45\textwidth}
        \includegraphics[width=\textwidth]{GenormHistogramAantalgen1.pdf}
        \caption{10000 simulations of number of generations until equilibrium with HR 1}
        \label{hist hap 1}
    \end{subfigure}
    \caption{The probability distribution of $Y$ (the number of generations until reaching the equilibrium) is approximated with a histogram of bin size 1. 
    For each HR ($\frac{1}{4}$, $\frac{1}{3}$, $\frac{1}{2}$ and $1$), $10000$ simulations were ran.}
    \label{fig:histogram}
\end{figure}


Looking at the histograms, all $Y_j$'s ($j\in \{\frac{1}{4},\frac{1}{3},\frac{1}{2},1\}$) might come from the same distribution, but with different parameters, since their sample means are obviously different.\\

For simplicity, we chose to mainly investigate the distribution of $Y_{1/3}$, since other $Y_j$'s might follow the same family distribution as suggested by the histograms. We suspected that $Y_{1/3}$ might be Poisson distributed. So with this assumption, we first used the 'fitdist'-function of Matlab to calculate the maximum likelihood estimator $\hat{\lambda}$ for the real Poisson parameter $\lambda$. Then, we performed the chi-squared test using the chi2gof function in Matlab, with null-hypothesis $H_0:F_{1/3}=F_{P,\hat{\lambda}}$, for which $F$ is the unknown cumulative distribution function (CDF) from the data and $F_{P,\hat{\lambda}}$, the CDF from Poisson$(\hat{\lambda})$. The alternative hypothesis is $F_{1/3}\neq F_{P,\hat{\lambda}}$. Furthermore, we chose 8 bins for the chi-squared test (otherwise the test is not accurate due to low expected counts in some bins). The test rejected the null-hypothesis and with significance level $\alpha=0.05$. \\   

With the same method, we also tested whether $Y_{1/3}$ could be binomially or negative binomially distributed. But once again, they have been rejected by the chi-squared test. So we can only conclude that $Y_{1/3}$ is not Poisson, binomially or negative binomially distributed.\\
We have also performed this statistical analysis on other $Y_j$'s (for instance $Y_1$), and  obtained the same result as for $Y_{1/3}$.\\

In order to make a better comparison of the distribution between $Y_{1/4},Y_{1/3},Y_{1/2}$ and $Y_1$, several QQ-plots were made. 
This is shown in Figure \ref{fig:QQ-plot}.\\ 

\begin{figure}[H]
    \centering
    \begin{subfigure}{0.8\textwidth}
    \includegraphics[width=\textwidth]{QQplotATGEN3.pdf}
    \caption{QQ-plot of $Y_{1}$ vs $Y_{1/2}$}
        \label{fig:QQplotATGEN3}
    \end{subfigure}
    
    \begin{subfigure}{0.8\textwidth}
    \includegraphics[width=\textwidth]{QQplotATGEN1.pdf}
    \caption{QQ-plot of $Y_{1/3}$ vs $Y_{1/2}$}
        \label{fig:QQplotATGEN1}
    \end{subfigure}
    
    \begin{subfigure}{0.8\textwidth}
    \includegraphics[width=\textwidth]{QQplotATGEN2.pdf}
    \caption{QQ-plot of $Y_{1/4}$ vs $Y_{1/2}$}
        \label{fig:QQplotATGEN2}
    \end{subfigure}
    \caption{QQ-plot of $Y_{1}$ vs $Y_{1/2}$, $Y_{1/3}$ vs $Y_{1/2}$ and $Y_{1/4}$ vs $Y_{1/2}$}
    \label{fig:QQ-plot}
\end{figure}

As expected, the QQ-plots have a stairwise pattern. 
This is because the data came from a discrete random variable. 
The plots appear to be linear, especially the plot of $Y_{1}$ vs $Y_{1/2}$. 
The plot indicates that these 4 $Y_j$'s might belong to the location-scale family of the same distribution.\\

With the two-sample Kolomogorov-Smirnov test (kstest2) of significance level $\alpha=0.05$ in Matlab, which has null-hypothesis $H_0:F(X)=G(Y)$ for $F,G$ the CDF of $X$ and $Y$, it can be concluded that these $Y_j$'s do not come from the same distribution with the same parameters. 
Unfortunately, we were not able to find a test that tests whether these $Y_j$'s comes from the same family distribution (i.e. same distribution but different parameter values).\\




